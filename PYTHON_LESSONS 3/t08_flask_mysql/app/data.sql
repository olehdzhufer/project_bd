-- MySQL Script generated by MySQL Workbench
-- Mon Oct  2 22:15:28 2023
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

DROP SCHEMA IF EXISTS `LAB1` ;

CREATE SCHEMA IF NOT EXISTS `LAB1` DEFAULT CHARACTER SET utf8 ;
USE `LAB1` ;



CREATE TABLE IF NOT EXISTS `LAB1`.`vending_machines` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `address` VARCHAR(45) NOT NULL,
  `gps_coordinates` VARCHAR(45) NOT NULL,
  `last_loading_date` DATE NOT NULL,
  PRIMARY KEY (`id`));

INSERT INTO vending_machines (id, address, gps_coordinates, last_loading_date) VALUES
(1, "Stefanyka, 7", "12432", "2022-10-12"),
(2, "Kopernyka, 8", "43221", "2023-11-01"),
(3, "Konovaltsa, 9", "53423", "2022-09-02"),
(4, "Orlyka, 10", "54334", "2023-11-10"),
(5, "Zelena, 11", "13523", "2022-09-09"),
(6, "Malevycha, 12", "32452", "2022-10-13"),
(7, "Bandera, 13", "98123", "2023-11-14"),
(8, "Saharova, 14", "43121", "2022-09-15"),
(9, "Orlyka, 15", "54326", "2023-11-16"),
(10, "Franka, 16", "89012", "2022-09-17");


DROP TABLE IF EXISTS `LAB1`.`vending_machine_menu` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`vending_machine_menu` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `vending_machines_id` INT NOT NULL,
  PRIMARY KEY (`id`, `vending_machines_id`),
  INDEX `fk_vending_machine_menu_vending_machines1_idx` (`vending_machines_id` ASC) VISIBLE,
  CONSTRAINT `fk_vending_machine_menu_vending_machines1`
    FOREIGN KEY (`vending_machines_id`)
    REFERENCES `LAB1`.`vending_machines` (`id`));


INSERT INTO vending_machine_menu(id, vending_machines_id) VALUES
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(6,6),
(7,7),
(8,8),
(9,9),
(10,10);

DROP TABLE IF EXISTS `LAB1`.`product` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`product` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `vending_machine_menu_id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `brand` VARCHAR(45) NULL,
  `price` INT NOT NULL,
  PRIMARY KEY (`id`, `vending_machine_menu_id`),
  INDEX `fk_product_vending_machine_menu1_idx` (`vending_machine_menu_id` ASC) VISIBLE,
  INDEX `price` (`price` ASC) VISIBLE,
  INDEX `name` (`name` ASC) VISIBLE,
  INDEX `brand` (`brand` ASC) VISIBLE,
  CONSTRAINT `fk_product_vending_machine_menu1`
    FOREIGN KEY (`vending_machine_menu_id`)
    REFERENCES `LAB1`.`vending_machine_menu` (`id`));

INSERT INTO product(id, vending_machine_menu_id, name, brand, price) VALUES
(1, 1, "snickers", "switoch", 100),
(2, 2, "bounty", "torchyn", 120),
(3, 3, "twix", "roshen", 130),
(4, 4, "mars", "lukas", 140),
(5, 5, "raffaelo", "amanti", 150),
(6, 6, "Sweet Sensations", "Sweetness Factory", 160),
(7, 7, "Candylicious Delights", "Delicious Delights Factory", 170),
(8, 8, "Icy Paradise", "Flavor Valley", 180),
(9, 9, "Caramel Breeze", "Sugar World", 190),
(10, 10, "Heavenly Treats", "Sugar World", 200);

DROP TABLE IF EXISTS `LAB1`.`available_snacks` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`available_snacks` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `current_quantity` VARCHAR(45) NOT NULL,
  `vending_machines_id` INT NOT NULL,
  `product_id` INT NOT NULL,
  PRIMARY KEY (`id`, `vending_machines_id`, `product_id`),
  INDEX `fk_available_snacks_product1_idx` (`product_id` ASC) VISIBLE,
  CONSTRAINT `fk_available_snacks_product1`
    FOREIGN KEY (`product_id`)
    REFERENCES `LAB1`.`product` (`id`));

INSERT INTO available_snacks (id, current_quantity, vending_machines_id, product_id ) VALUES
(1, 20, 1, 1),
(2, 30, 2, 2),
(3, 40, 3, 3),
(4, 50, 4, 4),
(5, 60, 5, 5),
(6, 70, 6, 6),
(7, 80, 7, 7),
(8, 90, 8, 8),
(9, 100, 9, 9),
(10, 110, 10, 10);


DROP TABLE IF EXISTS `LAB1`.`sold_snacks` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`sold_snacks` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `sale_data` DATE NOT NULL,
  `quantity_sold` INT NOT NULL,
  PRIMARY KEY (`id`));

INSERT INTO sold_snacks (id, sale_data, quantity_sold) VALUES
(1, "2023-10-09", 30),
(2, "2023-11-10", 40),
(3, "2023-12-11", 50),
(4, "2023-01-12", 60),
(5, "2023-02-13", 70),
(6, "2023-10-14", 80),
(7, "2023-11-15", 90),
(8, "2023-12-16", 100),
(9, "2023-01-17", 110),
(10, "2023-02-18", 120);


DROP TABLE IF EXISTS `LAB1`.`sold_snacks_has_vending_machines` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`sold_snacks_has_vending_machines` (
  `sold_snacks_id` INT NOT NULL,
  `vending_machines_id` INT NOT NULL,
  PRIMARY KEY (`sold_snacks_id`, `vending_machines_id`),
  INDEX `fk_sold_snacks_has_vending_machines_vending_machines1_idx` (`vending_machines_id` ASC) VISIBLE,
  INDEX `fk_sold_snacks_has_vending_machines_sold_snacks1_idx` (`sold_snacks_id` ASC) VISIBLE,
  CONSTRAINT `fk_sold_snacks_has_vending_machines_sold_snacks1`
    FOREIGN KEY (`sold_snacks_id`)
    REFERENCES `LAB1`.`sold_snacks` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_sold_snacks_has_vending_machines_vending_machines1`
    FOREIGN KEY (`vending_machines_id`)
    REFERENCES `LAB1`.`vending_machines` (`id`));

INSERT INTO sold_snacks_has_vending_machines (sold_snacks_id,vending_machines_id) VALUES
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(6,6),
(7,7),
(8,8),
(9,9),
(10,10);

DROP TABLE IF EXISTS `LAB1`.`collection` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`collection` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `collection_date` DATE NOT NULL,
  `collected__amount` INT NOT NULL,
  PRIMARY KEY (`id`));

INSERT INTO collection (id, collection_date, collected__amount) VALUES
(1, "2023-05-10", 1000),
(2, "2023-06-11", 2000),
(3, "2023-07-12", 3000),
(4, "2023-08-13", 4000),
(5, "2023-09-14", 5000),
(6, "2023-05-15", 6000),
(7, "2023-06-16", 7000),
(8, "2023-07-17", 8000),
(9, "2023-08-18", 9000),
(10, "2023-09-19", 10000);

CREATE INDEX idx_collection_collected__amount office_chairoffice_chairON collection (collected__amount);


DROP TABLE IF EXISTS `LAB1`.`coins` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`coins` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `coin_loading_date` DATE NOT NULL,
  `coin_amount` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`));

INSERT INTO coins (id, coin_loading_date, coin_amount) VALUES
(1, "2023-05-10", 1000),
(2, "2023-06-11", 2000),
(3, "2023-07-12", 3000),
(4, "2023-08-13", 4000),
(5, "2023-09-14", 5000),
(6, "2023-05-15", 7000),
(7, "2023-06-16", 8000),
(8, "2023-07-17", 9000),
(9, "2023-08-18", 10000),
(10, "2023-09-19", 11000);

CREATE INDEX idx_coin_coin_amount ON coins(coin_amount);


DROP TABLE IF EXISTS `LAB1`.`coins_has_vending_machines` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`coins_has_vending_machines` (
  `coins_id` INT NOT NULL,
  `vending_machines_id` INT NOT NULL,
  PRIMARY KEY (`coins_id`, `vending_machines_id`),
  INDEX `fk_coins_has_vending_machines_vending_machines1_idx` (`vending_machines_id` ASC) VISIBLE,
  INDEX `fk_coins_has_vending_machines_coins1_idx` (`coins_id` ASC) VISIBLE,
  CONSTRAINT `fk_coins_has_vending_machines_coins1`
    FOREIGN KEY (`coins_id`)
    REFERENCES `LAB1`.`coins` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_coins_has_vending_machines_vending_machines1`
    FOREIGN KEY (`vending_machines_id`)
    REFERENCES `LAB1`.`vending_machines` (`id`));

INSERT INTO coins_has_vending_machines (coins_id, vending_machines_id) VALUES
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(6,6),
(7,7),
(8,8),
(9,9),
(10,10);

DROP TABLE IF EXISTS `LAB1`.`technichan` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`technichan` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`));

INSERT INTO technichan (id, name) VALUES
(1, "Ivan"),
(2, "Oleh"),
(3, "Yura"),
(4, "Vova"),
(5, "Pavlo"),
(6, "Denys"),
(7, "Ostap"),
(8, "Danylo"),
(9, "Vytaliy"),
(10, "Bohdan");


DROP TABLE IF EXISTS `LAB1`.`technichan_has_vending_machines` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`technichan_has_vending_machines` (
  `technichan_id` INT NOT NULL,
  `vending_machines_id` INT NOT NULL,
  PRIMARY KEY (`technichan_id`, `vending_machines_id`),
  INDEX `fk_technichan_has_vending_machines_vending_machines1_idx` (`vending_machines_id` ASC) VISIBLE,
  INDEX `fk_technichan_has_vending_machines_technichan1_idx` (`technichan_id` ASC) VISIBLE,
  CONSTRAINT `fk_technichan_has_vending_machines_technichan1`
    FOREIGN KEY (`technichan_id`)
    REFERENCES `LAB1`.`technichan` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_technichan_has_vending_machines_vending_machines1`
    FOREIGN KEY (`vending_machines_id`)
    REFERENCES `LAB1`.`vending_machines` (`id`));

INSERT INTO technichan_has_vending_machines (technichan_id, vending_machines_id) VALUES
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(6,6),
(7,7),
(8,8),
(9,9),
(10,10);

DROP TABLE IF EXISTS `LAB1`.`product_has_available_snacks` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`product_has_available_snacks` (
  `product_id` INT NOT NULL,
  `product_vending_machine_menu_id` INT NOT NULL,
  `available_snacks_id` INT NOT NULL,
  `available_snacks_vending_machines_id` INT NOT NULL,
  PRIMARY KEY (`product_id`, `product_vending_machine_menu_id`, `available_snacks_id`, `available_snacks_vending_machines_id`),
  INDEX `fk_product_has_available_snacks_available_snacks1_idx` (`available_snacks_id` ASC, `available_snacks_vending_machines_id` ASC) VISIBLE,
  INDEX `fk_product_has_available_snacks_product1_idx` (`product_id` ASC, `product_vending_machine_menu_id` ASC) VISIBLE,
  CONSTRAINT `fk_product_has_available_snacks_product1`
    FOREIGN KEY (`product_id` , `product_vending_machine_menu_id`)
    REFERENCES `LAB1`.`product` (`id` , `vending_machine_menu_id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_product_has_available_snacks_available_snacks1`
    FOREIGN KEY (`available_snacks_id` , `available_snacks_vending_machines_id`)
    REFERENCES `LAB1`.`available_snacks` (`id` , `vending_machines_id`));

INSERT INTO product_has_available_snacks(product_id, product_vending_machine_menu_id, available_snacks_id, available_snacks_vending_machines_id ) VALUES
(1,1,1,1),
(2,2,2,2),
(3,3,3,3),
(4,4,4,4),
(5,5,5,5),
(6,6,6,6),
(7,7,7,7),
(8,8,8,8),
(9,9,9,9),
(10,10,10,10);


DROP TABLE IF EXISTS `LAB1`.`collection_has_vending_machines` ;

CREATE TABLE IF NOT EXISTS `LAB1`.`collection_has_vending_machines` (
  `collection_id` INT NOT NULL,
  `vending_machines_id` INT NOT NULL,
  PRIMARY KEY (`collection_id`, `vending_machines_id`),
  INDEX `fk_collection_has_vending_machines_vending_machines1_idx` (`vending_machines_id` ASC) VISIBLE,
  INDEX `fk_collection_has_vending_machines_collection1_idx` (`collection_id` ASC) VISIBLE,
  CONSTRAINT `fk_collection_has_vending_machines_collection1`
    FOREIGN KEY (`collection_id`)
    REFERENCES `LAB1`.`collection` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_collection_has_vending_machines_vending_machines1`
    FOREIGN KEY (`vending_machines_id`)
    REFERENCES `LAB1`.`vending_machines` (`id`));

INSERT INTO collection_has_vending_machines (collection_id, vending_machines_id) VALUES
(1,1),
(2,2),
(3,3),
(4,4),
(5,5),
(6,6),
(7,7),
(8,8),
(9,9),
(10,10);

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;